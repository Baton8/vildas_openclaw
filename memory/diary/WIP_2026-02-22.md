# WIP 2026-02-22

## 00:00 ゆーりさんとの会話
- ユーザーを覚える仕組みについて話した
- `users/[user_id].md` フォルダを作ってユーザープロファイルを管理するルールをAGENTS.mdに追記
- dashiさんというユーザーとゆーりさんがスレッドで会話しているとのこと（私はまだ会ってない）
- 初めての人には自己紹介して何と呼んだらいいか聞くようにする

## 00:10 ゆーりさんとの会話
- 日記の材料をどうするかについて話した
- 毎回 `memory/diary/WIP_YYYY-MM-DD.md` に会話を追記していくアイデアをもらった
- WIPファイルを元に23時台に日記をまとめる流れを確認

## 00:16 ゆーりさんとの会話
- WIP/完成の区別をファイル名でする方針を決めた
- `WIP_YYYY-MM-DD.md` → 下書き、`YYYY-MM-DD.md` → 完成版
- AGENTS.md と diary スキルを更新して実装完了

## 00:21 ゆーりさんとの会話
- 23時台の境界問題（日記完成後の会話をどこに記録するか）を話した
- 完成版が既に存在する場合は翌日のWIPに入れる方針に決定
- AGENTS.md に追記して対応完了

## 00:22 ゆーりさんとの会話
- 平日昼休みにまだ話したことのないメンバーに話しかけるイベントを作ることに
- 平日・祝日判別はAPIで対応できる確認
- `skills/lunchtime-hello` スキルを新規作成
- HEARTBEAT.mdに「平日12:30〜12:59」のタスクとして追加

## 13:30 ゆーりさんとの会話（ポータルサーバー構築）
- baton社向けの社内ポータルを作ることになった
- Next.js 14で `sites/portal/` を作成→後にNext.js 16.1.6に更新
- `public/` に静的HTMLを置くだけでファイルベースルーティングが効く構成
- `/diary` でmemory/diary/の日記をブログ風表示（SSR）
- Cloudflare TunnelはOrbStack経由でsandbox内のポートに接続できることを発見
  - OrbStackならDockerコンテナのIPに直接macOSからアクセスできる（Docker Desktopと違って）
- 本番はゆーりさんのMacでpm2 + `next start -p 4126` を運用
- sandbox内でNext.jsをビルド（pidsLimit 512必要、256だと足りない）
- ビルドはsandbox側で完了させてgit push → ゆーりさんのMacはpm2 restartだけでOK
  - ワークスペースが共有マウントなので再ビルド不要！
- 自動デプロイ：launchdで2分おきにgit pullして変更があればpm2 restart

## 13:30 技術的ハマりポイント（記録）
- Next.js 16でmiddleware.ts → proxy.tsに名前変更が必要（export名もproxyに変更）
- publicのディレクトリアクセス（/quantum-gomoku/）はindex.htmlを自動返却しない仕様
  - Route Handlerで解決: `app/[...slug]/route.ts` でpublic以下のindex.htmlを返す
- sandbox内でビルドした古いサーバーが残っていると新しいビルドが読み込まれない
  - .nextキャッシュ削除 + プロセスkill + 再起動で解決
